{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Digital Medical Passport (v1)",
  "type": "object",
  "additionalProperties": false,
  "required": ["PatientGuid", "Name", "DOB"],
  "properties": {
    "PatientGuid": { "type": "string", "format": "uuid" },
    "Name":        { "type": "string", "minLength": 1, "maxLength": 200 },
    "DOB":         { "type": "string", "format": "date" },
    "Sex":         { "type": "string", "enum": ["F", "M", "U", "I"] },
    "PostCode":    { "type": "string", "minLength": 2, "maxLength": 10 },

    "Allergies": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["term"],
        "properties": {
          "codeSystem": { "type": "string", "enum": ["SNOMED", "READ", "LOCAL"] },
          "code":       { "type": "string" },
          "term":       { "type": "string", "minLength": 1 },
          "assertedDate": { "type": "string", "format": "date" },
          "severity":   { "type": "string", "enum": ["mild", "moderate", "severe"] }
        }
      }
    },

    "Medications": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["term", "status"],
        "properties": {
          "medicationCode": { "type": "string" },
          "term":           { "type": "string", "minLength": 1 },
          "dosage":         { "type": "string" },
          "startDate":      { "type": "string", "format": "date" },
          "endDate":        { "type": "string", "format": "date" },
          "status":         { "type": "string", "enum": ["current", "past", "never"] },
          "prescriptionType": { "type": "integer", "enum": [1, 2, 3, 4] }
        }
      }
    },

    "Appointments": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["startDateTime"],
        "properties": {
          "AppointmentGuid": { "type": "string", "format": "uuid" },
          "startDateTime":   { "type": "string", "format": "date-time" },
          "endDateTime":     { "type": "string", "format": "date-time" },
          "status":          { "type": "integer", "enum": [2, 3, 4, 5, 7] },
          "location":        { "type": "string" }
        }
      }
    },

    "Events": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["eventType", "term", "effectiveDateTime"],
        "properties": {
          "EventGuid":         { "type": "string", "format": "uuid" },
          "eventType":         { "type": "integer", "enum": [1, 11, 13] },
          "term":              { "type": "string", "minLength": 1 },
          "readCode":          { "type": "string" },
          "snomedCTCode":      { "type": "string" },
          "effectiveDateTime": { "type": "string", "format": "date-time" }
        }
      }
    }
  }
}
